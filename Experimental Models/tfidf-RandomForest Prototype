{"cells":[{"cell_type":"markdown","source":["# LOADING AND PREPROCCESING DATA"],"metadata":{"id":"iwvjLrXB-Fh7"}},{"cell_type":"markdown","source":["## Loading libraries and dataset"],"metadata":{"id":"X1mCUPaydJAK"}},{"cell_type":"code","source":["import numpy as np\n","import pandas as pd\n","from tqdm import tqdm\n","\n","import re\n","import string\n","\n","import nltk\n","from nltk.corpus import stopwords\n","from nltk.stem import WordNetLemmatizer  \n","nltk.download('stopwords')\n","nltk.download('punkt')\n","\n","stop_words = stopwords.words('english')\n","\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import confusion_matrix,classification_report\n","from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\n","from sklearn.ensemble import RandomForestClassifier\n","from sklearn.metrics import confusion_matrix,classification_report\n","\n","import matplotlib.pyplot as plt\n","import seaborn as sns"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GQ1PmRoKbcRY","executionInfo":{"status":"ok","timestamp":1652982770891,"user_tz":420,"elapsed":505,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"ce3d7801-bf6c-488f-cbb3-6949118ba3f8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[nltk_data] Downloading package stopwords to /root/nltk_data...\n","[nltk_data]   Unzipping corpora/stopwords.zip.\n","[nltk_data] Downloading package punkt to /root/nltk_data...\n","[nltk_data]   Package punkt is already up-to-date!\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"USNIg83Zhe_w"},"outputs":[],"source":["import numpy as np\n","import tensorflow as tf\n","from tensorflow import keras\n","import tensorflow as tf\n","import tensorflow_hub as hub\n","# import tensorflow_text as text\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","import nltk\n","from sklearn.model_selection import train_test_split"]},{"cell_type":"code","source":["#upload the annotations.xlsx\n","from google.colab import files\n","uploaded = files.upload()"],"metadata":{"colab":{"resources":{"http://localhost:8080/nbextensions/google.colab/files.js":{"data":"Ly8gQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQwovLwovLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgovLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLy8KLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKLy8KLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQovLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAovLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAovLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCi8qKgogKiBAZmlsZW92ZXJ2aWV3IEhlbHBlcnMgZm9yIGdvb2dsZS5jb2xhYiBQeXRob24gbW9kdWxlLgogKi8KKGZ1bmN0aW9uKHNjb3BlKSB7CmZ1bmN0aW9uIHNwYW4odGV4dCwgc3R5bGVBdHRyaWJ1dGVzID0ge30pIHsKICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogIGVsZW1lbnQudGV4dENvbnRlbnQgPSB0ZXh0OwogIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHN0eWxlQXR0cmlidXRlcykpIHsKICAgIGVsZW1lbnQuc3R5bGVba2V5XSA9IHN0eWxlQXR0cmlidXRlc1trZXldOwogIH0KICByZXR1cm4gZWxlbWVudDsKfQoKLy8gTWF4IG51bWJlciBvZiBieXRlcyB3aGljaCB3aWxsIGJlIHVwbG9hZGVkIGF0IGEgdGltZS4KY29uc3QgTUFYX1BBWUxPQURfU0laRSA9IDEwMCAqIDEwMjQ7CgpmdW5jdGlvbiBfdXBsb2FkRmlsZXMoaW5wdXRJZCwgb3V0cHV0SWQpIHsKICBjb25zdCBzdGVwcyA9IHVwbG9hZEZpbGVzU3RlcChpbnB1dElkLCBvdXRwdXRJZCk7CiAgY29uc3Qgb3V0cHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG91dHB1dElkKTsKICAvLyBDYWNoZSBzdGVwcyBvbiB0aGUgb3V0cHV0RWxlbWVudCB0byBtYWtlIGl0IGF2YWlsYWJsZSBmb3IgdGhlIG5leHQgY2FsbAogIC8vIHRvIHVwbG9hZEZpbGVzQ29udGludWUgZnJvbSBQeXRob24uCiAgb3V0cHV0RWxlbWVudC5zdGVwcyA9IHN0ZXBzOwoKICByZXR1cm4gX3VwbG9hZEZpbGVzQ29udGludWUob3V0cHV0SWQpOwp9CgovLyBUaGlzIGlzIHJvdWdobHkgYW4gYXN5bmMgZ2VuZXJhdG9yIChub3Qgc3VwcG9ydGVkIGluIHRoZSBicm93c2VyIHlldCksCi8vIHdoZXJlIHRoZXJlIGFyZSBtdWx0aXBsZSBhc3luY2hyb25vdXMgc3RlcHMgYW5kIHRoZSBQeXRob24gc2lkZSBpcyBnb2luZwovLyB0byBwb2xsIGZvciBjb21wbGV0aW9uIG9mIGVhY2ggc3RlcC4KLy8gVGhpcyB1c2VzIGEgUHJvbWlzZSB0byBibG9jayB0aGUgcHl0aG9uIHNpZGUgb24gY29tcGxldGlvbiBvZiBlYWNoIHN0ZXAsCi8vIHRoZW4gcGFzc2VzIHRoZSByZXN1bHQgb2YgdGhlIHByZXZpb3VzIHN0ZXAgYXMgdGhlIGlucHV0IHRvIHRoZSBuZXh0IHN0ZXAuCmZ1bmN0aW9uIF91cGxvYWRGaWxlc0NvbnRpbnVlKG91dHB1dElkKSB7CiAgY29uc3Qgb3V0cHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG91dHB1dElkKTsKICBjb25zdCBzdGVwcyA9IG91dHB1dEVsZW1lbnQuc3RlcHM7CgogIGNvbnN0IG5leHQgPSBzdGVwcy5uZXh0KG91dHB1dEVsZW1lbnQubGFzdFByb21pc2VWYWx1ZSk7CiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXh0LnZhbHVlLnByb21pc2UpLnRoZW4oKHZhbHVlKSA9PiB7CiAgICAvLyBDYWNoZSB0aGUgbGFzdCBwcm9taXNlIHZhbHVlIHRvIG1ha2UgaXQgYXZhaWxhYmxlIHRvIHRoZSBuZXh0CiAgICAvLyBzdGVwIG9mIHRoZSBnZW5lcmF0b3IuCiAgICBvdXRwdXRFbGVtZW50Lmxhc3RQcm9taXNlVmFsdWUgPSB2YWx1ZTsKICAgIHJldHVybiBuZXh0LnZhbHVlLnJlc3BvbnNlOwogIH0pOwp9CgovKioKICogR2VuZXJhdG9yIGZ1bmN0aW9uIHdoaWNoIGlzIGNhbGxlZCBiZXR3ZWVuIGVhY2ggYXN5bmMgc3RlcCBvZiB0aGUgdXBsb2FkCiAqIHByb2Nlc3MuCiAqIEBwYXJhbSB7c3RyaW5nfSBpbnB1dElkIEVsZW1lbnQgSUQgb2YgdGhlIGlucHV0IGZpbGUgcGlja2VyIGVsZW1lbnQuCiAqIEBwYXJhbSB7c3RyaW5nfSBvdXRwdXRJZCBFbGVtZW50IElEIG9mIHRoZSBvdXRwdXQgZGlzcGxheS4KICogQHJldHVybiB7IUl0ZXJhYmxlPCFPYmplY3Q+fSBJdGVyYWJsZSBvZiBuZXh0IHN0ZXBzLgogKi8KZnVuY3Rpb24qIHVwbG9hZEZpbGVzU3RlcChpbnB1dElkLCBvdXRwdXRJZCkgewogIGNvbnN0IGlucHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlucHV0SWQpOwogIGlucHV0RWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlOwoKICBjb25zdCBvdXRwdXRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3V0cHV0SWQpOwogIG91dHB1dEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7CgogIGNvbnN0IHBpY2tlZFByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICAgIHJlc29sdmUoZS50YXJnZXQuZmlsZXMpOwogICAgfSk7CiAgfSk7CgogIGNvbnN0IGNhbmNlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogIGlucHV0RWxlbWVudC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGNhbmNlbCk7CiAgY2FuY2VsLnRleHRDb250ZW50ID0gJ0NhbmNlbCB1cGxvYWQnOwogIGNvbnN0IGNhbmNlbFByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgY2FuY2VsLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgIHJlc29sdmUobnVsbCk7CiAgICB9OwogIH0pOwoKICAvLyBXYWl0IGZvciB0aGUgdXNlciB0byBwaWNrIHRoZSBmaWxlcy4KICBjb25zdCBmaWxlcyA9IHlpZWxkIHsKICAgIHByb21pc2U6IFByb21pc2UucmFjZShbcGlja2VkUHJvbWlzZSwgY2FuY2VsUHJvbWlzZV0pLAogICAgcmVzcG9uc2U6IHsKICAgICAgYWN0aW9uOiAnc3RhcnRpbmcnLAogICAgfQogIH07CgogIGNhbmNlbC5yZW1vdmUoKTsKCiAgLy8gRGlzYWJsZSB0aGUgaW5wdXQgZWxlbWVudCBzaW5jZSBmdXJ0aGVyIHBpY2tzIGFyZSBub3QgYWxsb3dlZC4KICBpbnB1dEVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlOwoKICBpZiAoIWZpbGVzKSB7CiAgICByZXR1cm4gewogICAgICByZXNwb25zZTogewogICAgICAgIGFjdGlvbjogJ2NvbXBsZXRlJywKICAgICAgfQogICAgfTsKICB9CgogIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykgewogICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOwogICAgbGkuYXBwZW5kKHNwYW4oZmlsZS5uYW1lLCB7Zm9udFdlaWdodDogJ2JvbGQnfSkpOwogICAgbGkuYXBwZW5kKHNwYW4oCiAgICAgICAgYCgke2ZpbGUudHlwZSB8fCAnbi9hJ30pIC0gJHtmaWxlLnNpemV9IGJ5dGVzLCBgICsKICAgICAgICBgbGFzdCBtb2RpZmllZDogJHsKICAgICAgICAgICAgZmlsZS5sYXN0TW9kaWZpZWREYXRlID8gZmlsZS5sYXN0TW9kaWZpZWREYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ24vYSd9IC0gYCkpOwogICAgY29uc3QgcGVyY2VudCA9IHNwYW4oJzAlIGRvbmUnKTsKICAgIGxpLmFwcGVuZENoaWxkKHBlcmNlbnQpOwoKICAgIG91dHB1dEVsZW1lbnQuYXBwZW5kQ2hpbGQobGkpOwoKICAgIGNvbnN0IGZpbGVEYXRhUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4gewogICAgICAgIHJlc29sdmUoZS50YXJnZXQucmVzdWx0KTsKICAgICAgfTsKICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpOwogICAgfSk7CiAgICAvLyBXYWl0IGZvciB0aGUgZGF0YSB0byBiZSByZWFkeS4KICAgIGxldCBmaWxlRGF0YSA9IHlpZWxkIHsKICAgICAgcHJvbWlzZTogZmlsZURhdGFQcm9taXNlLAogICAgICByZXNwb25zZTogewogICAgICAgIGFjdGlvbjogJ2NvbnRpbnVlJywKICAgICAgfQogICAgfTsKCiAgICAvLyBVc2UgYSBjaHVua2VkIHNlbmRpbmcgdG8gYXZvaWQgbWVzc2FnZSBzaXplIGxpbWl0cy4gU2VlIGIvNjIxMTU2NjAuCiAgICBsZXQgcG9zaXRpb24gPSAwOwogICAgZG8gewogICAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1pbihmaWxlRGF0YS5ieXRlTGVuZ3RoIC0gcG9zaXRpb24sIE1BWF9QQVlMT0FEX1NJWkUpOwogICAgICBjb25zdCBjaHVuayA9IG5ldyBVaW50OEFycmF5KGZpbGVEYXRhLCBwb3NpdGlvbiwgbGVuZ3RoKTsKICAgICAgcG9zaXRpb24gKz0gbGVuZ3RoOwoKICAgICAgY29uc3QgYmFzZTY0ID0gYnRvYShTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGNodW5rKSk7CiAgICAgIHlpZWxkIHsKICAgICAgICByZXNwb25zZTogewogICAgICAgICAgYWN0aW9uOiAnYXBwZW5kJywKICAgICAgICAgIGZpbGU6IGZpbGUubmFtZSwKICAgICAgICAgIGRhdGE6IGJhc2U2NCwKICAgICAgICB9LAogICAgICB9OwoKICAgICAgbGV0IHBlcmNlbnREb25lID0gZmlsZURhdGEuYnl0ZUxlbmd0aCA9PT0gMCA/CiAgICAgICAgICAxMDAgOgogICAgICAgICAgTWF0aC5yb3VuZCgocG9zaXRpb24gLyBmaWxlRGF0YS5ieXRlTGVuZ3RoKSAqIDEwMCk7CiAgICAgIHBlcmNlbnQudGV4dENvbnRlbnQgPSBgJHtwZXJjZW50RG9uZX0lIGRvbmVgOwoKICAgIH0gd2hpbGUgKHBvc2l0aW9uIDwgZmlsZURhdGEuYnl0ZUxlbmd0aCk7CiAgfQoKICAvLyBBbGwgZG9uZS4KICB5aWVsZCB7CiAgICByZXNwb25zZTogewogICAgICBhY3Rpb246ICdjb21wbGV0ZScsCiAgICB9CiAgfTsKfQoKc2NvcGUuZ29vZ2xlID0gc2NvcGUuZ29vZ2xlIHx8IHt9OwpzY29wZS5nb29nbGUuY29sYWIgPSBzY29wZS5nb29nbGUuY29sYWIgfHwge307CnNjb3BlLmdvb2dsZS5jb2xhYi5fZmlsZXMgPSB7CiAgX3VwbG9hZEZpbGVzLAogIF91cGxvYWRGaWxlc0NvbnRpbnVlLAp9Owp9KShzZWxmKTsK","ok":true,"headers":[["content-type","application/javascript"]],"status":200,"status_text":""}},"base_uri":"https://localhost:8080/","height":73},"id":"1knbrDffiJ_K","executionInfo":{"status":"ok","timestamp":1652982797884,"user_tz":420,"elapsed":20288,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"e9a9ed83-8acb-4a2b-f7dd-0638e7b6f113"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","     <input type=\"file\" id=\"files-7d41f663-44de-4a6f-b7b8-fe0f319ec8f6\" name=\"files[]\" multiple disabled\n","        style=\"border:none\" />\n","     <output id=\"result-7d41f663-44de-4a6f-b7b8-fe0f319ec8f6\">\n","      Upload widget is only available when the cell has been executed in the\n","      current browser session. Please rerun this cell to enable.\n","      </output>\n","      <script src=\"/nbextensions/google.colab/files.js\"></script> "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Saving annotations.xlsx to annotations.xlsx\n"]}]},{"cell_type":"markdown","source":["Dropping center (so only right and left remian) and then one-hot encoding\n"],"metadata":{"id":"ImSoGM72dGxc"}},{"cell_type":"code","source":["#convert the excelt data into a data frame\n","df = pd.read_excel(\"annotations.xlsx\",index_col=0 )\n","#drop all columns except for sentence and it's political leaning (type)\n","df.drop(df.columns.difference([\"text\",\"type\"]), 1, inplace=True)\n","\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TRRYake-qyX9","executionInfo":{"status":"ok","timestamp":1652982804709,"user_tz":420,"elapsed":6834,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"1159123c-af4f-48cd-8c05-1669cae68e06"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:4: FutureWarning: In a future version of pandas all arguments of DataFrame.drop except for the argument 'labels' will be keyword-only\n","  after removing the cwd from sys.path.\n"]}]},{"cell_type":"code","source":["df = df[df[\"type\"] != \"center\"]"],"metadata":{"id":"4ANQ2OXmq3Nh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["one_hot = pd.get_dummies(df[\"type\"])\n","one_hot = one_hot.drop(\"right\",axis = 1)\n","print(one_hot)\n","#Printing only the one hot encoded "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2owyM0jtscjq","executionInfo":{"status":"ok","timestamp":1652982804711,"user_tz":420,"elapsed":62,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"7b07c391-6bfe-4226-f1a8-7be554de54cc"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["       left\n","0         0\n","1         1\n","2         1\n","3         0\n","4         0\n","...     ...\n","22462     0\n","22463     0\n","22467     1\n","22469     1\n","22470     0\n","\n","[14476 rows x 1 columns]\n"]}]},{"cell_type":"code","source":["#create a one hot encoding by political leaning\n","#drop the type column\n","df = df.drop(\"type\",axis = 1)\n","#add the one hot encoding to the main data frame\n","df = df.join(one_hot)\n","print(df)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_IBFHxLOs4xD","executionInfo":{"status":"ok","timestamp":1652982804712,"user_tz":420,"elapsed":52,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"5b1cd65c-8f61-4887-8737-729de9d016c6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["                                                    text  left\n","0      The transgender effort to suppress any recogni...     0\n","1      Radical Virginia Citizens Defense League has o...     1\n","2      Miller is the architect of President Donald Tr...     1\n","3      The House Democratsâ€™ 1,400-page coronavirus re...     0\n","4      A specter is haunting the West; our elites see...     0\n","...                                                  ...   ...\n","22462  We used to think of interracial marriage as a ...     0\n","22463  The two men are known to be friendly and frequ...     0\n","22467  But President Donald Trump and his campaign ad...     1\n","22469  And so, while demonstrations began to spread a...     1\n","22470  House and Senate Democrats are responding to t...     0\n","\n","[14476 rows x 2 columns]\n"]}]},{"cell_type":"markdown","source":["## Splitting the dataset into X (all sentences) and Y all corrosponding labels"],"metadata":{"id":"kpIx04RkdzWm"}},{"cell_type":"code","source":["#splitting the dataset\n","X = df.iloc[:,0]\n","Y = df.iloc[:, 1]"],"metadata":{"id":"2qMBLEq1k8pS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(X)\n","print(Y)\n"],"metadata":{"id":"ftEp101tnZLg","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1652820491526,"user_tz":420,"elapsed":547,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"35047cd3-034d-4988-dc44-2af9b1be5c70"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["0        The transgender effort to suppress any recogni...\n","1        Radical Virginia Citizens Defense League has o...\n","2        Miller is the architect of President Donald Tr...\n","3        The House Democratsâ€™ 1,400-page coronavirus re...\n","4        A specter is haunting the West; our elites see...\n","                               ...                        \n","22462    We used to think of interracial marriage as a ...\n","22463    The two men are known to be friendly and frequ...\n","22467    But President Donald Trump and his campaign ad...\n","22469    And so, while demonstrations began to spread a...\n","22470    House and Senate Democrats are responding to t...\n","Name: text, Length: 14476, dtype: object\n","0        0\n","1        1\n","2        1\n","3        0\n","4        0\n","        ..\n","22462    0\n","22463    0\n","22467    1\n","22469    1\n","22470    0\n","Name: left, Length: 14476, dtype: uint8\n"]}]},{"cell_type":"code","source":["sw = stopwords.words('english')\n","nltk.download('wordnet')\n","lemmatizer = WordNetLemmatizer() \n","\n","def clean_text(text):\n","    \n","    text = text.lower()\n","    \n","    text = re.sub(r\"[^a-zA-Z?.!,Â¿]+\", \" \", text) # replacing everything with space except (a-z, A-Z, \".\", \"?\", \"!\", \",\")\n","    \n","    punctuations = '@#!?+&*[]-%.:/();$=><|{}^' + \"'`\" + '_'\n","    for p in punctuations:\n","        text = text.replace(p,'') #Removing punctuations\n","        \n","    text = [word.lower() for word in text.split() if word.lower() not in sw]\n","    \n","    text = [lemmatizer.lemmatize(word) for word in text]\n","    \n","    text = \" \".join(text) #removing stopwords\n","    return text"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EdUV6W0fcBtm","executionInfo":{"status":"ok","timestamp":1652982839808,"user_tz":420,"elapsed":690,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"3e2e483c-8754-465b-fd2b-6ea6160f99f8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[nltk_data] Downloading package wordnet to /root/nltk_data...\n","[nltk_data]   Unzipping corpora/wordnet.zip.\n"]}]},{"cell_type":"code","source":["df['text'] = df['text'].apply(lambda x: clean_text(x))\n"," \n","df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":263},"id":"w53R1aaAcYpX","executionInfo":{"status":"ok","timestamp":1652982846942,"user_tz":420,"elapsed":4882,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"287527c0-77fe-40e0-9dc5-a97302ff965e"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                text  left\n","0  transgender effort suppress recognition men wo...     0\n","1  radical virginia citizen defense league organi...     1\n","2  miller architect president donald trump hardli...     1\n","3  house democrat , page coronavirus recovery bil...     0\n","4  specter haunting west elite see intolerant aut...     0"],"text/html":["\n","  <div id=\"df-dd51dcbf-8fbf-4a27-a5bb-4469148240db\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>left</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>transgender effort suppress recognition men wo...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>radical virginia citizen defense league organi...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>miller architect president donald trump hardli...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>house democrat , page coronavirus recovery bil...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>specter haunting west elite see intolerant aut...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dd51dcbf-8fbf-4a27-a5bb-4469148240db')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dd51dcbf-8fbf-4a27-a5bb-4469148240db button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dd51dcbf-8fbf-4a27-a5bb-4469148240db');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":13}]},{"cell_type":"markdown","source":["Making all sentences lower case in XðŸ‘‡"],"metadata":{"id":"TYR6NmnpeBEc"}},{"cell_type":"markdown","source":["now that data is tokenized we will split it using train test splitðŸ‘‡"],"metadata":{"id":"HPl1dLH_e9Zc"}},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","X_train, X_test , y_train, y_test = train_test_split(df['text'].values,df['left'].values,test_size=0.2,random_state=123,stratify=df['left'].values)"],"metadata":{"id":"RudJzyTrvPkl"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["tfidf_vectorizer = TfidfVectorizer() \n","\n","tfidf_train_vectors = tfidf_vectorizer.fit_transform(X_train)\n","\n","tfidf_test_vectors = tfidf_vectorizer.transform(X_test)"],"metadata":{"id":"F8oVUjOkeA6Y"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Random FOrest classifer\n"],"metadata":{"id":"shWuReY7eMve"}},{"cell_type":"code","source":["classifier = RandomForestClassifier()\n","\n","classifier.fit(tfidf_train_vectors,y_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ed4WJoyMeC0A","executionInfo":{"status":"ok","timestamp":1652983163962,"user_tz":420,"elapsed":3456,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"7853afd2-c408-49ea-d7a7-ed8826b90f38"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["RandomForestClassifier()"]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["y_pred = classifier.predict(tfidf_test_vectors)"],"metadata":{"id":"mA1GN4BYeVNM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(classification_report(y_pred,y_test))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wVcL_b1leX1C","executionInfo":{"status":"ok","timestamp":1652983181991,"user_tz":420,"elapsed":202,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"2a7bda70-870e-4579-c7c8-92adb82f4d42"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","           0       1.00      1.00      1.00      1447\n","           1       1.00      1.00      1.00      1449\n","\n","    accuracy                           1.00      2896\n","   macro avg       1.00      1.00      1.00      2896\n","weighted avg       1.00      1.00      1.00      2896\n","\n"]}]},{"cell_type":"code","source":["print(y_pred)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3oI0IAbVgipp","executionInfo":{"status":"ok","timestamp":1652983746529,"user_tz":420,"elapsed":233,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"8a35e032-b526-4329-d448-a10e127987fd"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[1 1 1 ... 0 1 1]\n"]}]},{"cell_type":"code","source":["names = [\"Right\",\"Left\"]\n","thingss = []\n","for index, value in enumerate(y_pred):\n","  # print(index, value)\n","  thingss.append(names[value])\n"],"metadata":{"id":"M0GjjKRJe8I5"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(thingss)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"R7q447_Hhdl0","executionInfo":{"status":"ok","timestamp":1652983980672,"user_tz":420,"elapsed":192,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"ec0e9a62-f4f1-41a3-9ea0-4457901d1a4c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Right', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left', 'Left', 'Right', 'Left', 'Left', 'Right', 'Left', 'Left']\n"]}]},{"cell_type":"code","source":["cnf_matrix = confusion_matrix(y_test,y_pred)\n","group_names = ['TN','FP','FN','TP']\n","group_counts = [\"{0:0.0f}\".format(value) for value in cnf_matrix.flatten()]\n","labels = [f\"{v1}\\n{v2}\" for v1, v2 in zip(group_names,group_counts)]\n","labels = np.asarray(labels).reshape(2,2)\n","sns.heatmap(cnf_matrix, annot=labels, fmt='', cmap='Blues');"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":265},"id":"GN4ZHZTZelEm","executionInfo":{"status":"ok","timestamp":1652983225970,"user_tz":420,"elapsed":661,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"529bddd6-248a-49ca-eae9-a38d9738cc00"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"markdown","source":["trying it out for a single sentence"],"metadata":{"id":"rwVG0DYHerAt"}},{"cell_type":"code","source":["output = clean_text(\"The Democratic Party is desperate to bolster its flagging support among Latino voters heading into the midterm elections.\")\n","print(output)\n","shapedOutput = [output]\n","tfidf_manual_vector = tfidf_vectorizer.transform(shapedOutput)\n","manualPred = classifier.predict(tfidf_manual_vector)\n","names = [\"Right\",\"Left\"]\n","print(\"Predicted as:\", names[manualPred[0]])\n","\n","\n","# manualPred = model.predict(output)\n","# print(manualPred)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"I8WDbTKqeq0Y","executionInfo":{"status":"ok","timestamp":1652984371784,"user_tz":420,"elapsed":336,"user":{"displayName":"Michael Rimboim","userId":"10409174233422570990"}},"outputId":"1f1ae751-4022-4404-c293-86addb9c48be"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["democratic party desperate bolster flagging support among latino voter heading midterm election\n","Predicted as: Left\n"]}]}],"metadata":{"colab":{"collapsed_sections":[],"name":"tfidf-RandomForest Prototype","provenance":[{"file_id":"1VatfiJ-d2VdEk5ws1YuB2dwCPwV3tzC4","timestamp":1652982262649},{"file_id":"1X9ROtUmykK8VJ452_Pa6NjDWqhgeW1Ov","timestamp":1652825314149},{"file_id":"https://github.com/keras-team/keras-io/blob/master/examples/nlp/ipynb/pretrained_word_embeddings.ipynb","timestamp":1652329716403}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.0"}},"nbformat":4,"nbformat_minor":0}